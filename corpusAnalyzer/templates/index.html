<!--
	Author: W3layouts
	Author URL: http://w3layouts.com
	License: Creative Commons Attribution 3.0 Unported
	License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!-- {% load static %} -->
<!DOCTYPE html>
<html>
<head>
    <!-- BOOTSTRAPR4 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <title>File Upload widget a Flat Responsive Widget Template :: w3layouts</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link href='//fonts.googleapis.com/css?family=Open+Sans:400,300italic,300,400italic,600,600italic,700,700italic,800,800italic'
          rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>


    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="keywords"
          content="File Upload widget Widget Responsive, Login Form Web Template, Flat Pricing Tables, Flat Drop-Downs, Sign-Up Web Templates, Flat Web Templates, Login Sign-up Responsive Web Template, Smartphone Compatible Web Template, Free Web Designs for Nokia, Samsung, LG, Sony Ericsson, Motorola Web Design"/>
    <script src="{% static 'js/bootbox.js' %}"></script>
    <script type="application/x-javascript"> addEventListener("load", function () {
        setTimeout(hideURLbar, 0);
    }, false);

    function hideURLbar() {
        window.scrollTo(0, 1);
    } </script>
</head>

<body>
    <div class="container">
        <div class="row">
            <h1>Add your files here</h1>
        </div>
            
            <div class="agile-its" >
                    <h2>File Upload</h2>
                    <div class="w3layouts">
                        <p>You can drag & drop files from your desktop on this webpage.</p>
                        <div class="photos-upload-view">
                            <form id="upload" action="" method="POST" enctype="multipart/form-data">
                                <input type="hidden" id="MAX_FILE_SIZE" name="MAX_FILE_SIZE" value="300000"/>
                                <div class="agileinfo">
                                    <input type="submit" class="choose" value="Choose file..">
                                    <h3>OR</h3>
                                    <input type="file" id="fileselect" name="fileselect[]" multiple="multiple"/>
                                    <div id="filedrag">drag and drop files here</div>
                                </div>
                            </form>
                            <div id="messages">
                                <p>Status Messages</p>
                            </div>
                            <button class="btnquery" onclick="send_file_to_backend()">click here to extract terms</button>
                        </div>
                        <div class="clearfix"></div>
                        <script src="{% static 'js/filedrag.js' %}"></script>
                
                    </div>
                </div>
        <div class="footer">
                <p> Â© 2016 File Upload widget. All Rights Reserved | Design by <a href="http://w3layouts.com/"> W3layouts</a></p>
        </div>
    </div>




<script type="text/javascript" src="{% static 'js/jquery.js' %}"></script>

<script>
    function send_file_to_backend() {
        let formdata = new FormData($('#file_upload')[0])
        alert(formdata)
        $.ajax({
            type: "POST",
            cache: false,
            url: "ajax/handle_extract_file_term/12138",
            data: formdata,
            processData: false,
            contentType: false,
            async: true,
            timeout: 500000,
            beforeSend: function (xhr, setting) {
                xhr.setRequestHeader("X-CSRFToken", "{{csrf_token}}")
            },

            error: function () {
                bootbox.confirm("extraction failed, please check if files are valid", function () {
                    spinHide()
                    location.reload()
                })
            },
            success: function (result_filename) {
                spinHide()
                console.log(result_filename)
                if (result_filename != "failed") {
                    bootbox.confirm({
                        title: "extraction succeed!",
                        message:
                            "<p>click technical term download button to download resulting technical terms</p>",
                        callback: function () {
                            {#location.reload()#}
                        },
                    })
                } else {
                    bootbox.confirm({
                        title: "extraction failed!",
                        message:
                            "<p>internal server error, please try again later</p>",
                        callback: function () {
                            {#location.reload()#}
                        },
                    })
                }
            }
        })
    }
    // BOOTSTRAP4
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
</html>